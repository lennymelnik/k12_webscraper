define(["underscore","jquery","container.view","./table.model","./row/row.widget"],function(e,t,n,r,i){"use strict";return n.extend({template:"table.hbs",events:{"click .cell>.expand-icon":"toggleCollapse"},initialize:function(){n.prototype.initialize.apply(this,arguments),this.model=new r,this.listenTo(this.model,"change",this.render)},afterRender:function(){var t;this.addHeaderRow(),e.each(this.model.get("data"),function(e,n){t=".table-widget > .tbody > :nth-child("+(n+1)+")",e.templates=this.model.get("rowsTemplate"),this.addRow(e,t)},this),this.addDefaultDataRow(),this.addFooterRow(),this._initTooltips()},addHeaderRow:function(){var t={templates:[],components:[]};return e.each(this.model.get("headers"),function(e){t.components.push(e)},this),e.isEmpty(t.components)?!1:(t.templates=this.model.get("headerTemplate"),this.addRow(t,".table-widget > .thead > :first-child"),!0)},createComponentRow:function(t){return e.nvl(t,{components:[t||{}]},!1)},addRow:function(e,t){var n=new i;this.addView(t,n),this.setView(t),n.model.set(e),this.listenTo(n,"deleted",this.handleDefaultDataDisplay)},addDefaultDataRow:function(){var e=this.createComponentRow(this.model.get("defaultData"));e&&this.addRow(e,".table-default-data"),this.handleDefaultDataDisplay()},addFooterRow:function(){var e=this.createComponentRow(this.model.get("footer"));e&&this.addRow(e,".table-footer")},handleDefaultDataDisplay:function(){this.$el.find(".table-data-row").length===0&&(this.$el.find(".table-default-data").removeClass("hidden"),this.$el.find(".th-row").addClass("hidden"))},toggleCollapse:function(e){t(e.target).closest(".row").toggleClass("collapsed")},showSpinner:function(){this.$el&&(this.model.get("spinnable")||this.model.getDeep("config.spinnable"))&&this.$el.spinner("show")},hideSpinner:function(){this.$el&&(this.model.get("spinnable")||this.model.getDeep("config.spinnable"))&&this.$el.spinner("hide")}})});